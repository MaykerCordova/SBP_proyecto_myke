隆Claro que s铆, Myke! Para una auditor铆a o para entregar el proyecto formalmente, necesitas un **Documento de Especificaci贸n T茅cnica y Funcional**.

Este documento debe responder a tres preguntas que todo auditor hace:

1. **驴Qu茅 hace?** (Funcionalidad).
2. **驴C贸mo lo hace?** (L贸gica y C贸digo).
3. **驴Es seguro y fiable?** (Integridad de datos).

Aqu铆 tienes el borrador completo y profesional. Puedes copiarlo y pegarlo en un Word.

---

# DOCUMENTACIN TCNICA Y FUNCIONAL

## Proyecto: Automatizaci贸n RPA de Bit谩cora de Reglas de Fraude

**Autor:** Jose Mayker Cordova Pintado
**Rol:** Analista de Prevenci贸n de Fraude / Data Scientist
**Fecha:** 27 de Diciembre, 2025
**Versi贸n:** 1.0

---

### 1. RESUMEN EJECUTIVO

El presente proyecto tiene como objetivo la automatizaci贸n integral del registro, control y seguimiento de las reglas de fraude implementadas en las herramientas de monitoreo (Monitor Plus, Falcon, VRM, etc.).

Se ha desarrollado un **Robot RPA (Robotic Process Automation)** basado en Python que intercepta las solicitudes v铆a correo electr贸nico, extrae la informaci贸n cr铆tica mediante procesamiento de lenguaje natural (Regex), calcula m茅tricas de eficiencia operativa y asegura la persistencia de datos en un entorno dual (Excel + SQLite), alimentando finalmente un Dashboard de control en Power BI.

### 2. ARQUITECTURA DE LA SOLUCIN

El sistema opera bajo una arquitectura local h铆brida que garantiza la operatividad incluso sin conexi贸n a servidores centrales de base de datos.

* **Entrada (Input):** Microsoft Outlook (Protocolo MAPI).
* **Procesamiento (Core):** Python 3.13 (Librer铆as: `pywin32`, `pandas`, `sqlite3`, `re`).
* **Almacenamiento (Storage):**
* **Frontend:** Excel (`.xlsx`) para visualizaci贸n de usuario final.
* **Backend:** SQLite (`.db`) para integridad transaccional y conexi贸n con BI.


* **Salida (Output):** Power BI Desktop (Dashboard de KPIs).

### 3. DICCIONARIO DE COMPONENTES (DOCUMENTACIN DE CDIGO)

A continuaci贸n, se detalla la estructura modular del script `bitacora.py`.

#### A. M贸dulo de Configuraci贸n (`CONFIG`)

Diccionario est谩tico que centraliza las rutas de acceso y par谩metros del sistema.

* **Objetivo:** Permitir la migraci贸n del robot a otros entornos sin modificar el c贸digo fuente.
* **Variables Clave:** `RUTA_EXCEL`, `RUTA_DB`, `CARPETA_SOLICITUDES`.

#### B. Clase `HerramientasOutlook` (Capa de Conexi贸n)

Encargada de la interacci贸n con el cliente de correo.

* **Funci贸n `buscar_carpeta()`:** Recorre recursivamente el 谩rbol de carpetas de Outlook hasta encontrar la bandeja destino.
* **Funci贸n `guardar_msg()`:** Descarga el correo f铆sico (`.msg`) en una ruta de auditor铆a como evidencia inmutable de la solicitud.

#### C. Clase `ProcesadorTexto` (Motor L贸gico)

N煤cleo de inteligencia del robot. Utiliza Expresiones Regulares (Regex) para "leer" correos desestructurados.

* **Patrones Regex:** Se definieron patrones flexibles (Insensitive Case) para capturar campos como `HERRAMIENTA:`, `ACCIN:`, y `CONDICIN:` ignorando espacios o errores menores de tipeo.
* **Normalizaci贸n:** Convierte fechas y textos a formatos est谩ndar para evitar duplicidad.

#### D. Clase `GestorBitacora` y `GestorBackupSQL` (Capa de Datos)

Manejan la escritura en disco.

* **Integridad Dual:** El sistema escribe primero en SQLite (transaccional) y luego en Excel. Si el Excel falla (por estar abierto), la base de datos SQLite asegura que el dato no se pierda.
* **Manejo de Tipos:** Se fuerza el tipado `String` (Texto) en `Pandas` para evitar que c贸digos como "005" se conviertan en "5" o que fechas se corrompan.

#### E. L贸gica de Negocio (Main Loop)

El orquestador principal ejecuta el siguiente flujo:

1. **Lectura:** Escanea correos "No Le铆dos".
2. **Generaci贸n de ID nico:** Crea un c贸digo compuesto (`Correlativo` + `Fecha` + `Herramienta` + `Condici贸n`) para trazabilidad 煤nica.
3. **C谩lculo de Estimaci贸n:** Consulta la tabla maestra de tiempos (`MAPA_ESTIMACION`) para asignar autom谩ticamente el ahorro de horas hombre.
4. **Cierre:** Marca el correo como "Le铆do" solo si el guardado fue exitoso.

### 4. FLUJO DEL PROCESO (BPMN)

*(Aqu铆 puedes referenciar la imagen del diagrama que generaste en Camunda).*

1. **Solicitud:** El analista env铆a correo con plantilla est谩ndar.
2. **Extracci贸n:** El robot detecta variables clave y asigna ID.
3. **Registro Pendiente:** Se guarda la l铆nea con estado "Pendiente".
4. **Aprobaci贸n:** El gerente responde "OK/Conforme".
5. **Cierre de Ciclo:** El robot actualiza el registro con fecha/hora de aprobaci贸n y cambia estado a "Completado".

### 5. CONTROLES DE SEGURIDAD Y AUDITORA

Para cumplir con los est谩ndares de riesgo operacional:

* **Evidencia Forense:** Cada registro en la bit谩cora est谩 vinculado a un archivo `.msg` guardado en el servidor, permitiendo auditor铆a forense en caso de disputas.
* **Base de Datos Blindada:** El uso de SQLite previene la corrupci贸n de datos t铆pica de archivos Excel compartidos y evita bloqueos de lectura/escritura (File Locking) cuando Power BI actualiza.
* **Logs de Ejecuci贸n:** El sistema emite alertas en consola (Warnings) si detecta inconsistencias en tipos de datos, sin detener la operaci贸n cr铆tica.

### 6. ESCALABILIDAD FUTURA

El sistema est谩 dise帽ado para escalar hacia una orquestaci贸n BPMN formal.

* **Fase Actual:** L贸gica hardcodeada en Python (`MAPA_ESTIMACION`).
* **Fase Futura:** Integraci贸n con **Camunda 7**, donde las reglas de estimaci贸n se gestionar谩n mediante tablas DMN visuales, permitiendo ajustes por parte del negocio sin intervenci贸n de TI.

---

###  Recomendaci贸n Final para tu Word

1. Copia este texto en un Word.
2. Ponle el logo de tu banco en la esquina superior.
3. Agrega las **capturas del diagrama de Camunda** en la secci贸n 4.
4. Agrega una captura peque帽a del c贸digo (donde se ve la clase `GestorBitacora`) en la secci贸n 3.

隆Con esto tienes un entregable de nivel Senior, Myke! 驴Te parece bien la estructura?
